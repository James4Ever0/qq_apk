<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<title>最近在听</title>
<script type="text/javascript">
window.SPD={_timing:[],_render_start:Date.now(),mark:function(a,b){this._timing[a]=a+"="+((b||Date.now())-this._render_start)}};
</script>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
<style type="text/css">
body,div,ul,li,h1,h2,h3,h4,h5,h6,p{margin:0;padding:0}img{border:0}li{list-style:none}a{-webkit-touch-callout:none}body{-webkit-user-select:none;font:12px/1.5 "hiragino sans gb",Arial;background-color:#3a4747;-webkit-tap-highlight-color:rgba(0,0,0,0)}html,body{width:100%;height:100%;overflow:hidden}.wrap{display:-webkit-box;-webkit-box-orient:vertical;position:relative;z-index:3;height:100%}.gene{position:relative;-webkit-box-flex:1}.gene_item{position:absolute;top:50%;left:50%;border-radius:700px;border:solid 1px rgba(255,255,255,.2);-webkit-transition:.5s}.gene_item .color{opacity:.6}.gene_item img,.gene_item .color{position:absolute;top:0;left:0;z-index:-1;width:100%;height:100%;border-radius:700px}.gene_item h2{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:center;color:#fff}.gene_item_1 h2{margin-top:55px;font-size:22px}.gene_item_2 h2,.gene_item_3 h2{margin-top:32px;font-size:18px}.gene_item_4 h2,.gene_item_5 h2,.gene_item_6 h2,.gene_item_7 h2,.gene_item_8 h2,.gene_item_9 h2{margin-top:20px;font-size:12px}.gene_item p{text-align:center;color:rgba(255,255,255,.6)}.gene_item_1 p{font-size:18px}.gene_item_4 p,.gene_item_5 p,.gene_item_6 p,.gene_item_7 p,.gene_item_8 p,.gene_item_9 p{font-size:9px}.gene_item_1 img,.gene_item_2 img,.gene_item_3 img{opacity:.6}.gene_item_4 img,.gene_item_5 img,.gene_item_6 img,.gene_item_7 img,.gene_item_8 img,.gene_item_9 img{opacity:.4}.gene_item_4 .ani_playing,.gene_item_5 .ani_playing,.gene_item_6 .ani_playing,.gene_item_7 .ani_playing,.gene_item_8 .ani_playing,.gene_item_9 .ani_playing{margin-top:20px}.ani_guide{opacity:0;position:absolute;top:0;left:0;z-index:10;width:100%;height:100%}.ani_guide i{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:700px;background:rgba(0,0,0,.75) url(http://imgcache.gtimg.cn/mediastyle/mobile/app/qq/img/ani_guide_light.png?max_age=2592000);background-position:0 -22px;background-size:cover;-webkit-animation:rotate 3s linear infinite;-webkit-transform:translate3d(0,0,0)}.gene_item_2 .ani_guide i,.gene_item_3 .ani_guide i{background-position:0 -14px}.gene_item_4 .ani_guide i,.gene_item_5 .ani_guide i,.gene_item_6 .ani_guide i,.gene_item_7 .ani_guide i,.gene_item_8 .ani_guide i,.gene_item_9 .ani_guide i{background-position:0 -9px}.ani_guide:after{content:"";position:absolute;top:50%;left:50%;width:38px;height:44px;margin:-22px 0 0 -15px;background:url(http://imgcache.gtimg.cn/mediastyle/mobile/app/qq/img/ani_guide_arrow.png?max_age=2592000);background-size:cover}.gene_item_2 .ani_guide:after,.gene_item_3 .ani_guide:after{zoom:.7}.gene_item_4 .ani_guide:after,.gene_item_5 .ani_guide:after,.gene_item_6 .ani_guide:after,.gene_item_7 .ani_guide:after,.gene_item_8 .ani_guide:after,.gene_item_9 .ani_guide:after{zoom:.5}.gene_item_1{z-index:4;width:140px;height:140px;margin:-70px 0 0 -70px}.gene_item_2,.gene_item_3{z-index:3;width:90px;height:90px;margin:-45px 0 0 -45px;opacity:0}.gene_item_4,.gene_item_5,.gene_item_6,.gene_item_7,.gene_item_8,.gene_item_9{z-index:2;width:56px;height:56px;margin:-28px 0 0 -28px;opacity:0}.expand .gene_item_2{-webkit-transform:translate3d(-105px,80px,0)}.expand .gene_item_3{-webkit-transform:translate3d(105px,-80px,0)}.expand .gene_item_4{-webkit-transform:translate3d(-127px,-30px,0)}.expand .gene_item_5{-webkit-transform:translate3d(-75px,-112px,0)}.expand .gene_item_6{-webkit-transform:translate3d(40px,-145px,0)}.expand .gene_item_7{-webkit-transform:translate3d(120px,50px,0)}.expand .gene_item_8{-webkit-transform:translate3d(90px,165px,0)}.expand .gene_item_9{-webkit-transform:translate3d(8px,136px,0)}.expand .gene_item{opacity:1}.small_gene.current h2{display:none}.circle_bg{position:absolute;top:50%;left:50%;z-index:1;border:solid 1px rgba(255,255,255,.1);border-radius:700px}.circle_bg_1{width:192px;height:192px;-webkit-transform:translate3d(-96px,-96px,0)}.circle_bg_2{width:276px;height:276px;-webkit-transform:translate3d(-138px,-138px,0)}.circle_bg_3{width:378px;height:378px;-webkit-transform:translate3d(-189px,-189px,0)}.circle_bg_4{width:510px;height:510px;-webkit-transform:translate3d(-255px,-255px,0)}.user_info{position:relative;height:65px;padding-left:56px}.user_info .avatar{position:absolute;left:15px;width:30px;height:30px;border-radius:3px;border:solid 1px #fff}.user_info .avatar img{display:block;width:100%;height:100%;border-radius:3px}.user_info .user_name{position:relative;line-height:16px;margin-top:-2px}.user_info .user_name span{display:inline-block;max-width:100px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-right:5px;vertical-align:middle;font-size:12px;color:rgba(255,255,255,.6)}.user_info .source{font-size:9px;color:rgba(255,255,255,.4)}.user_info .music_logo{position:absolute;top:18px;right:10px;height:13px;line-height:14px;font-size:9px;color:rgba(255,255,255,.4)}.user_info i{float:left;width:13px;height:13px;margin-right:2px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaAgMAAADUJKRdAAAADFBMVEX////////////////1pQ5zAAAABHRSTlMAESIzthWI6wAAAKJJREFUeNodzi0OwkAQBeC3EEBU9AgcoTeAHgFBuAYeMxwBj6gCQ0hvQDlCBUGyGFQNgqSkYfcx0xHzZX7EA7QW1jAa14Y78mamBR+5KsJSDy5WUT7AkLLiD0johVHf2HgSyNg15FYNrTknN+TVPJtC7oW1zq9T2e8LejWLFRv9nwayZY60M4GJGYCB+dUcevdvdSZc79Tkfoh97kv17HVLbX+4dWfMuPxFewAAAABJRU5ErkJggg==);background-size:cover}.tips{position:absolute;top:70px;left:0;z-index:11;width:100%;opacity:0;-webkit-transform:translateY(-100%);-webkit-transition:-webkit-transform .25s}.tips.on{opacity:1;-webkit-transform:translateY(0)}.tips p{height:30px;line-height:30px;margin:0 10px;text-align:center;font-size:14px;color:#fff;border-radius:0 0 3px 3px;background:rgba(0,0,0,.7)}.bg{opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;background:50% 50% no-repeat;background-size:cover;-webkit-transition:opacity 1s}.bg_mask{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4)}.fadeIn{opacity:1}.ani_playing{display:block}.ani_playing b{display:block;width:20px;height:16px;overflow:hidden;margin:0 auto;pointer-events:none;-webkit-transform-style:preserve-3d}.ani_playing i{float:left;width:2px;height:16px;margin-right:4px;border-radius:2px;background-color:#FFF}.ani_playing i:nth-of-type(4){margin-right:0}.ani_playing i{-webkit-animation-name:bounce;-webkit-animation-timing-function:ease-in-out;-webkit-animation-fill-mode:forwards;-webkit-animation-iteration-count:infinite;-webkit-animation-direction:alternate}.ani_playing i:nth-of-type(1){-webkit-animation-duration:400ms}.ani_playing i:nth-of-type(2){-webkit-animation-duration:600ms}.ani_playing i:nth-of-type(3){-webkit-animation-duration:700ms}.ani_playing i:nth-of-type(4){-webkit-animation-duration:500ms}@-webkit-keyframes bounce{0%{-webkit-transform:translate3d(0,11px,0)}100%{-webkit-transform:translate3d(0,0,0)}}@-webkit-keyframes rotate{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(360deg)}}.mod_prompt{position:relative;padding:210px 10px 0;text-align:center;color:#8f8f8f}.mod_prompt h6{font-size:18px;line-height:36px}.mod_prompt.ip{background:url(http://imgcache.gtimg.cn/mediastyle/mobile/app/qq/img/ip_limited.png?max_age=2592000) center 90px no-repeat;background-size:100px 100px}.ios .tips{top:64px}.nosysbar .tips{top:50px}.ios.nosysbar .tips{top:44px}.mTop{margin-top:64px}.nosupport .tips{top:0}.nosupport .mTop{margin-top:0}
</style>
</head>
<body>
<div id="bg" class="bg online"></div><div class="bg_mask online"></div>
<div class="wrap online">
	<div class="gene mTop">
		<div class="circle_bg circle_bg_1"></div>
		<div class="circle_bg circle_bg_2"></div>
		<div class="circle_bg circle_bg_3"></div>
		<div class="circle_bg circle_bg_4"></div>
	</div>
	<div class="user_info" id="user_info"></div>
	<div class="tips" id="tips"><p></p></div>
</div>
<script type="text/javascript" src="http://imgcache.gtimg.cn/music/mobile/gene/js/common.js?max_age=2592000&v2"></script> 
<script type="text/javascript">
!function(){function g(){$(".ani_playing").remove(),$(".gene_item.current").removeClass("current"),qqmusicBridge.invoke({action:"SONG_GET_LIST_INFO"},function(a){$(".ani_playing").remove(),$(".gene_item.current").removeClass("current"),a&&0==a.code&&a.uin==b&&a.geneId&&a.list&&a.list.length&&1==a.state&&($('.gene_item[data-id="'+a.geneId+'"]').append('<span class="ani_playing"><b><i></i><i></i><i></i><i></i></b></span>').addClass("current"),h.timer&&clearInterval(h.timer))})}function h(){var a,b,c;return $(".ani_playing").length?!1:(a=$(".gene_item"),b=a.length,c=0,$(a[0]).append('<div class="ani_guide"><i></i></div>'),$(".ani_guide").anim({opacity:1},.7),2>b||(h.timer=setInterval(function(){var d=~~(Math.random()*b);d==c&&(d=~~(Math.random()*b)),c=d,$(".ani_guide").anim({opacity:0},.7,"",function(){$(".ani_guide").remove(),$(a[d]).append('<div class="ani_guide"><i></i></div>'),$(".ani_guide").anim({opacity:.7})})},5e3)),void 0)}function i(){var a=new Date,c=a.getYear()+""+a.getMonth()+a.getDate(),d=e["gene"+b];if(d)try{d=JSON.parse(d),d.date==c&&d.data&&0==d.data.code&&d.data.genelist&&d.data.genelist.length?k(d.data):j()}catch(f){j()}else j()}function j(a){$.ajax({url:"http://3g.music.qq.com/fcgi-bin/get_user_music_gene?qq="+b+"&cid=336",dataType:"jsonp",success:function(a){var c,d;a&&0==a.code?(k(a),c=new Date,d=c.getYear()+""+c.getMonth()+c.getDate(),e.setItem("gene"+b,JSON.stringify({date:d,data:a}))):M.tips("基因获取失败, 请稍候再试!")}})}function k(a){var d,f,i,j,k,l;if(SPD.mark(1),d="",a.vipinfo&&1==a.vipinfo.isvip&&a.vipinfo.vipnum>0&&(d+='<img src="http://imgcache.gtimg.cn/music/icon/lv'+a.vipinfo.vipnum+'.png?max_age=25920000" />'),c=M.escape(M.unescape(a.username)),f='<div class="avatar">	<img src="'+a.userimg+'" />'+"</div>"+'<div class="info">'+'	<p class="user_name"><span>'+c+"</span>"+d+"</p>"+'	<p class="source">来自QQ资料 - 最近在听</p>'+'	<div class="music_logo"><i></i>QQ音乐</div>'+"</div>",$("#user_info").html(f),i=a.genelist,!i.length)return e.removeItem("gene"+b),alert("暂无基因数据, 请稍候重试!"),!1;for(i=i.sort(function(a,b){return a.score>b.score?-1:a.score<b.score?1:0}),i=i.sort(function(a,b){return 2==a.type?2==b.type?0:-1:2==b.type?1:0}),j="",k=0;k<i.length;k++)l=i[k],j+='<div class="gene_item gene_item_'+(k+1)+" "+(k>2?" small_gene":"")+'" data-name="'+M.escape(M.unescape(l.name))+'" data-id="'+l.id+'" data-type="'+l.type+'" >'+"	<h2>"+M.escape(M.unescape(l.name))+"</h2>"+(l.picurl?'	<img src="'+l.picurl.replace(/_300\/(\d+)\/300_/,"/$1/150_")+'" />':"")+(l.color?'<div class="color" style="background:#'+l.color+'"></div>':"")+"</div>";$(j).insertBefore(".circle_bg_1"),i.length<4&&M.getUin()==M.getParameter("uin")&&M.tips("在QQ音乐听的越多,音乐基因越丰富"),setTimeout(function(){$(".gene").addClass("expand")},300),imgBlur($(".gene_item_1 img").attr("src")),$(".gene_item_1 img").on("load",function(){SPD.mark(2)}),g(),$.os.ios&&parseInt($.os.version)>=6&&h(),qqmusicBridge.bind("CALLPAGE_SHARE",function(){(!$.os.ios||mqq.invoke("ui","pageVisibility"))&&qqmusicBridge.invoke({action:"SHARE_GENE",data:{title:c+"最近在听",desc:"了解我，从我喜欢的音乐开始",imgUrl:$(".gene_item_1 img").attr("src")||"http://imgcache.gtimg.cn/mediastyle/mobile/app/qq/img/share_default.jpg?max_age=25920000",src:location.href+"&_wv=3"}},function(a){M.tj.sendClick("gene.sharegene")})})}var a,b,c,d,e,l;SPD.mark(0),a=!0,b="",c="",d=document.body,e=!1;try{e=localStorage,e.spt=!0}catch(f){e=!1}M.getParameter("uin")&&(b=M.getParameter("uin")),b||alert("参数错误!,缺少uin"),$.os.ios&&parseFloat($.os.version)>=7||$.os.android&&parseFloat($.os.version)>=4.4||(d.className+=" nosysbar"),$.os.ios&&(d.className+=" ios"),h.timer=null,i(),qqmusicBridge.onApp("DO_MACK_IMG_CALLBACK",function(a){if(a&&a.data.imgUrl){var b=new Image;b.src=a.data.imgUrl,$("#bg")[0].style.backgroundImage="url("+b.src+")",$("#bg")[0].className+=" fadeIn"}}),FastClick.attach(d),qqmusicBridge.onApp("CALLPAGE_SONG_STATE_CHANGE",function(a){a?1==a.state&&g():M.tips("获取播放状态出错")},function(a){a&&0==a.code||M.tips("播放状态回调事件绑定失败!"+a)}),l="您的Android系统版本过低,暂不支持本功能!",$.os.android&&parseFloat($.os.version)<2.2&&alert(l),$(window).on("pageshow",function(){g(),window.scrollTo(0,1)}),$(document).on("click",".gene_item",function(){return-1==a?confirm("版本较低,是否升级到最新版本?")&&(location.href="http://fwd.3g.qq.com:8080/forward.jsp?bid=1054"):-2==a?alert("抱歉!本应用只支持在手机QQ中打开!"):$.os.android&&parseFloat($.os.version)<2.2?alert(l):location.href="play.html?_bid=155&uin="+b+"&id="+this.getAttribute("data-id")+"&type="+this.getAttribute("data-type")+"&name="+encodeURIComponent(this.getAttribute("data-name")),!1}),$.ajax({url:"http://s.plcloud.music.qq.com/fcgi-bin/p.fcg?g_tk="+getACSRFToken(),dataType:"jsonp",callback:"MusicJsonCallback",success:function(a){a&&0==a.ret&&(d.innerHTML='<div class="mod_prompt ip"><h6>IP限制</h6><p>由于版权合约的限制，QQ音乐暂时无法给位于中国大陆以外的国家或地区提供音乐服务。</p></div>',d.style.background="#fff")}}),window.onload=function(){SPD.mark(3),SPD.send(SPD._timing),M.loadjs("http://imgcache.gtimg.cn/music/mobile/gene/js/ping.m.js?max_age=25920000",function(){M.tj.pv({ADTAG:M.getParameter("ADTAG")})})},mqq.device.getClientInfo?mqq.device.getClientInfo(function(b){parseFloat(b.qqVersion)<4.7&&(a=-1,d.className+=" nosupport")}):(a=-2,d.className+=" nosupport"),document.addEventListener("touchmove",function(a){a.preventDefault()},!1)}();
</script>
</body>
</html>