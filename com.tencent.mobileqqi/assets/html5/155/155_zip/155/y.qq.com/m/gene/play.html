<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<title>最近在听</title>
<meta name="format-detection" content="telephone=no" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
<script type="text/javascript">
window.SPD={_timing:[],_render_start:Date.now(),mark:function(a,b){this._timing[a]=a+"="+((b||Date.now())-this._render_start)},flag:["flag1=170","flag2=111","flag3=43"]}
</script>
<style type="text/css">
body,div,ul,li,h1,h2,h3,h4,h5,h6,p{margin:0;padding:0}img{border:0}li{list-style:none}a{color:#0079ff;text-decoration:none;-webkit-touch-callout:none}body{-webkit-user-select:none;font:12px/1.5 "hiragino sans gb",Arial;background-color:#FFF;-webkit-tap-highlight-color:rgba(0,0,0,0)}html,body{width:100%;height:100%}.wrap{position:relative;z-index:3;height:100%;overflow:hidden}.flex_box{display:-webkit-box;-webkit-box-orient:vertical;position:absolute;left:0;top:0;bottom:182px;width:100%}.slide_container{-webkit-box-flex:1;position:relative;width:100%;height:100%}.slide{position:absolute;left:0;top:0;bottom:0;width:200%}.slide .slide_item{float:left;position:relative;width:50%;height:100%}.gene_info{height:47px;line-height:47px;margin-top:10px;background:rgba(0,0,0,.1)}.gene_info .avata{float:left;width:30px;height:30px;margin:7px 0 0 12px;border:solid 1px #fff;border-radius:700px;background:#3a4747 padding-box}.gene_info img{display:block;width:100%;height:100%;border-radius:700px}.gene_info h2{float:left;max-width:100px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-left:7px;font-size:15px;color:#fff}.gene_info .line{float:left;width:1px;height:15px;margin:15px 10px 0;background:rgba(255,255,255,.25)}.gene_info p{float:left;overflow:hidden;white-space:nowrap;color:rgba(255,255,255,.5)}.gene_info .user_name{float:left;max-width:65px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-right:7px}.cover_container{position:relative;height:100%}.cover{position:absolute;top:50%;left:50%;width:214px;height:214px;margin:-107px 0 0 -107px;border:solid 1px rgba(255,255,255,.25);border-radius:700px;background:rgba(0,0,0,.1) padding-box}.cover .pic{width:194px;height:194px;margin:10px;border-radius:700px;background:#3a4747}.cover img{width:100%;height:100%;border-radius:700px}.lyric{position:absolute;top:22px;bottom:13px;left:0;width:100%;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}.lyric p{line-height:28px;margin:0 30px;font-size:15px;color:rgba(255,255,255,.5);text-align:center}.lyric .current{color:#fff}.slide_tab{position:absolute;left:0;bottom:162px;height:20px;width:100%;text-align:center}.slide_tab li{display:inline-block;width:5px;height:5px;text-indent:-999em;overflow:hidden;margin-right:5px;background:rgba(255,255,255,.5);border-radius:5px;vertical-align:top}.slide_tab li.current{background:#fff}.song_info{position:absolute;left:0;bottom:115px;height:47px;width:100%;background:rgba(0,0,0,.1)}.song_info h1,.song_info p{margin:0 47px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:center}.song_info h1{line-height:24px;margin-top:2px;font-size:18px;font-weight:normal;color:#fff}.song_info p{line-height:16px;color:rgba(255,255,255,.5)}.song_info .download,.song_info .love,.song_info .loved{position:absolute;top:0;width:47px;height:47px;line-height:999em;overflow:hidden}.song_info .download{left:0}.sprite i{position:absolute;background-image:url(http://imgcache.gtimg.cn/mediastyle/mobile/app/qq/img/sprite_play.png?max_age=2592000);background-size:50px 300px}.song_info .download i{top:14px;left:14px;width:17px;height:17px}.song_info .download.tapped i{opacity:.5}.song_info .love,.song_info .loved{right:0}.song_info .love i,.song_info .loved i{top:16px;left:16px;width:18px;height:16px;background-position:0 -30px}.song_info .loved i{background-position:0 -60px}.ctrl_btn{position:absolute;left:0;bottom:0;height:115px;width:100%}.ctrl_btn .prev,.ctrl_btn .next,.ctrl_btn .play{position:absolute;top:50%;border:solid 1px #fff;border-radius:700px;background:rgba(255,255,255,.1) padding-box}.ctrl_btn .play{left:50%;height:62px;width:62px;margin:-32px 0 0 -32px}.ctrl_btn .prev,.ctrl_btn .next{width:35px;height:35px;margin-top:-16px}.ctrl_btn .prev{left:50px}.ctrl_btn .next{right:50px}.ctrl_btn .play i{top:20px;left:24px;width:21px;height:23px;background-position:0 -115px}.ctrl_btn .pause i{background-position:2px -148px}.ctrl_btn .prev i,.ctrl_btn .next i{top:13px;left:13px;width:9px;height:11px;background-position:0 -90px}.ctrl_btn .next i{background-position:-11px -90px}.ctrl_btn .prev.tapped,.ctrl_btn .next.tapped,.ctrl_btn .play.tapped,.ctrl_btn .pause.tapped{background:rgba(255,255,255,0.5)}.tips{position:absolute;top:70px;left:0;z-index:11;width:100%;opacity:0;-webkit-transform:translateY(-100%);-webkit-transition:-webkit-transform .25s}.tips.on{opacity:1;-webkit-transform:translateY(0)}.tips p{height:30px;line-height:30px;margin:0 10px;text-align:center;font-size:14px;color:#fff;border-radius:0 0 3px 3px;background:rgba(0,0,0,.7)}.tips.succ p:before{content:"";display:inline-block;width:11px;height:8.5px;margin-right:5px;vertical-align:middle;background-position:0 -180px}.popup{position:absolute;bottom:0;left:0;z-index:11;width:100%;-webkit-transform:translateY(100%);-webkit-transition:all .25s}.popup.on{-webkit-transform:translateY(0)}.popup .btn{display:block;height:44px;line-height:44px;margin:0 8px 8px;text-align:center;font-size:20px;border-radius:4px;background:rgba(255,255,255,.85)}.mask{display:none;position:absolute;top:0;bottom:0;z-index:10;width:100%;background:rgba(0,0,0,.6)}.bg{position:absolute;top:0;left:0;width:100%;height:100%;background-position:center;background-color:#3a4747;background-repeat:no-repeat;background-size:cover}.bg_mask{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4)}.short_screen .flex_box{bottom:137px}.short_screen .gene_info{margin-top:0}.short_screen .slide_tab{bottom:127px;height:10px}.short_screen .song_info{bottom:80px}.short_screen .ctrl_btn{height:80px}.mod_prompt{padding:210px 10px 0;text-align:center;color:#8f8f8f}.mod_prompt h6{font-size:18px;line-height:36px}.ios .tips{top:64px}.flex_box{top:64px}.nosysbar .tips{top:50px}.ios.nosysbar .tips{top:44px}.nosysbar .flex_box{top:44px}.lyric .cont{height:100%}#mod_lrc{padding-bottom:100px}#canvas{position:absolute;top:5px;left:5px;width:204px;height:204px}
</style>
</head>
<body>
<div id="bg" class="bg online" ></div>
<div class="bg_mask online"></div>
<div class="wrap online">
	<div class="flex_box">
		<div class="gene_info"></div>
		<div class="slide_container">
			<div class="slide" id="slide">
				<div class="slide_item">	
					<div class="cover_container">
						<div class="cover" id="cover">	
							<div class="pic"></div>
							<canvas id="canvas" width="408" height="408"></canvas>
						</div>
					</div>			
				</div>
				<div class="slide_item">
					<div class="lyric">
						<div class="cont" id="scroll_lrc">
							<div id="mod_lrc"></div>
				        </div>
				    </div>
			    </div>
			</div>
		</div>
	</div>
	<ul class="slide_tab">
	    <li class="current"></li><li></li>
	</ul>	
	<div class="song_info">
		<h1 id="songname"></h1>
		<p id="singername"></p>
		<a href="javascript:;" class="sprite download"><i></i></a>
		<a href="javascript:;" class="sprite love"><i></i></a>
	</div>
	<div class="ctrl_btn">
		<a href="javascript:;" class="sprite prev"><i></i></a>
		<a href="javascript:;" class="sprite play" id="play"><i></i></a>
		<a href="javascript:;" class="sprite next"><i></i></a>
	</div>
	<div class="tips" id="tips">
		<p></p>
	</div>
	<div class="popup" id="download_tip">
		<a href="javascript:;" class="btn normal openInMusic">在QQ音乐中下载</a>
		<a href="javascript:;" class="btn cancel">取消</a>
	</div>
	<div class="mask"></div>
</div>
<script type="text/javascript" src="http://imgcache.gtimg.cn/music/mobile/gene/js/common.js?max_age=2592000&v2"></script> 
<script type="text/javascript">!function(){function f(a){var d,e,f,g,b=encodeURIComponent(a),c="";for(d=0,e=b.length;e>d;)f=b.charAt(d),g="","%"===f?(g=b.substring(d,d+3),d+=3):(g=b.charCodeAt(d),g="%"+g.toString(16),d++),c+=g;return c.replace(/%/g,"").toUpperCase()}function g(a){var b="",c={song_Name:encodeURIComponent(M.unescape(M.unescape(a.songName))),song_WapLiveURL:a.playUrl,song_WifiURL:a.playUrl,netType:"wap",song_Album:encodeURIComponent(M.unescape(M.unescape(a.albumName))),song_ID:parseInt(a.songId),song_Type:1,song_Singer:encodeURIComponent(M.unescape(M.unescape(a.singerName))),song_WapDownLoadURL:a.playUrl},d=f(decodeURIComponent(window.JSON.stringify(c)));b=$.os.ios?"qqmusic2.4://from=webPlayer&data="+d:"AndroidQQMusic://from=webPlayer&data="+d,e.open(b)}function p(a){mqq.device.getNetworkType&&mqq.device.getNetworkType(function(b){return M.netWork=b,0==b?(L(),void 0):(a&&a(b),void 0)})}function u(){document.getElementById("slide").style.cssText="-webkit-transition-duration:500ms;-webkit-transform: translate3d(0,0,0);",$(".slide_tab li")[0].className="current",$(".slide_tab li")[1].className=""}function v(){document.getElementById("slide").style.cssText="-webkit-transition-duration:500ms;-webkit-transform: translate3d(-"+q+"px,0,0);",$(".slide_tab li")[0].className="",$(".slide_tab li")[1].className="current"}function x(a,b){if(x.lock)return!1;x.lock=!0;var c="http://s.plcloud.music.qq.com/fcgi-bin/fcg_musiclist_getmyfav.fcg?songid="+a;c=M.buildUrl(c),$.ajax({url:c,dataType:"jsonp",callback:"getmyfavCallback",success:function(b){x.lock=!1,b&&b.map&&(1==b.map[a]?$(".love").addClass("loved"):$(".love").removeClass("loved"))},error:function(a){x.lock=!1}})}function y(a,b){var d="http://s.plcloud.music.qq.com/fcgi-bin/fcg_music_add2songdir.fcg",e={dirid:201,idlist:a,source:104,typelist:13,formsender:1,utf8:1,g_tk:getACSRFToken()},f=new c(d,"post",e,"utf-8");f.onSuccess=function(a){switch(a.code){case 0:b&&b(1);break;case 1:alert("操作失败,请稍候再试");break;case 31:case 32:case 41:alert("喜欢歌曲数目达到上限，不能再喜欢歌曲。");break;default:alert("服务器繁忙，请稍后再试。")}},f.send()}function z(a,b){var d="http://qzone-music.qq.com/fcg-bin/fcg_music_delbatchsong.fcg",e={uin:M.getUin(),dirid:201,ids:a,source:103,types:13,formsender:1,flag:2,from:3,utf8:1,g_tk:getACSRFToken()},f=new c(d,"post",e,"utf-8");f.onSuccess=function(a){a&&0==a.code?b&&b(1):M.tips("服务器繁忙,请稍候再试")},f.send()}function A(a,b,c){if(!b)return"";var d=b.charAt(b.length-2),e=b.charAt(b.length-1);return"http://imgcache.qq.com/music/photo/mid_"+a+"_"+(c||68)+"/"+d+"/"+e+"/"+b+".jpg"}function B(){var a=new Date,b=a.getYear()+""+a.getMonth()+a.getDate(),c=LS["gene"+l+n+m];if(c)try{c=JSON.parse(c),c.date==b&&c.data&&0==c.data.code?D(c.data):C()}catch(d){C()}else C()}function C(){$.ajax({url:"http://3g.music.qq.com/fcgi-bin/get_gene_listenlist?qq="+l+"&cid=337&genetype="+n+"&geneid="+m,dataType:"jsonp",success:function(a){var b,c;a&&0==a.code?(D(a),b=new Date,c=b.getYear()+""+b.getMonth()+b.getDate(),LS.setItem("gene"+l+n+m,JSON.stringify({date:c,data:a}))):M.tips("数据错误, 请稍候再试!")}})}function D(a){var b,c,d;if(SPD.mark(1),!a.songlist&&!a.songlist.length)return M.tips("没有歌曲"),!1;for(h=[],b=0;b<a.songlist.length;b++)c=a.songlist[b],h.push({playUrl:"http://"+M.audioServer+".stream.qqmusic.qq.com/"+(c.songid||"C100"+c.songmid)+".m4a?fromtag=0",songPage:"http://data.music.qq.com/playsong.html?songid="+c.songid,songId:c.songid,songName:M.escape(M.unescape(c.songname)),singerId:c.singerid,singerName:M.escape(M.unescape(c.singername)),albumName:M.escape(M.unescape(c.albumname)),albummid:c.albummid,albumImg:A("album",c.albummid,300),albumImgThumb:A("album",c.albummid)});d='<div class="avata" '+(a.color?' style="background-color:#'+a.color+'"':"")+">"+(a.picurl?'<img src="'+a.picurl.replace(/_300\/(\d+)\/300_/,"/$1/150_")+'" alt="" />':"")+"</div>"+'<h2 class="gene_name">'+M.escape(M.unescape(a.name))+"</h2>"+'<span class="line"></span>'+'<p><span class="user_name">'+M.escape(M.unescape(a.username))+"</span> 最近听过"+h.length+"首</p>",LS&&LS.setItem("gene_info",d),$(".gene_info").html(d),document.title=M.unescape(a.name),F(0)}function E(a){p(function(b){1!=b&&-1!=b&&1!=$.cookie.get("gene_agree_play")?mqq.ui.showDialog({title:"提示",text:"您当前可能不是WIFI网络,继续播放会消耗流量.确定继续播放?"},function(b){b&&0==b.button&&($.cookie.set("gene_agree_play",1,"","",2),a&&a())}):a&&a()})}function F(a,b){return h.length?(H(h[a||0]),E(function(){G(a)}),void 0):(B(),!1)}function G(a){qqmusicBridge.invoke({action:"SONG_PLAY",data:{index:a||0,geneId:m,geneType:n,uin:l,list:h}},function(a){a?-1003==a.code?M.tips("正在进行多人语音,无法播放歌曲!"):0!=a.code&&M.tips("播放歌曲失败"):M.tips("播放歌曲失败")})}function H(a){if(a.totalTime&&parseInt(a.totalTime)>0){var b=parseInt(360*(a.curTime/a.totalTime));t.to(b,!0),$.os.ios||($("#canvas").hide(),$("#canvas").show())}return a.songId&&H.id!=a.songId?(H.id=a.songId,J(a.albumImgThumb),p(function(b){var c=1==b?300:150;$(".pic").html('<img id="cover" src="'+A("album",a.albummid,c)+'" onerror="M.imgerror()" />')}),$("#songname").html(M.escape(M.unescape(a.songName))),$("#singername").html(M.escape(M.unescape(a.singerName))),$("#mod_lrc").html("<p>歌词加载中...</p>"),d.getLrc(a.songId,"#mod_lrc"),x(a.songId),i=a,void 0):!1}function I(){qqmusicBridge.invoke({action:"SONG_GET_SONG_INFO"},function(a){a?0==a.code?a.songId||0==a.state?(i=a,4==a.state?(M.tips("歌曲正在缓冲..."),M.tips.timer&&clearTimeout(M.tips.timer)):$("#tips").removeClass("on"),1==a.state?$("#play").addClass("pause"):$("#play").removeClass("pause"),parseInt(a.totalTime)>0&&H(a)):M.tips("歌曲数据错误"):101==a.code?$("#play").removeClass("pause"):-1003==a.code?M.tips("正在进行多人语音, 无法播放!"):M.tips("歌曲数据错误"):M.tips("缺少数据!")})}function J(a){a&&qqmusicBridge.invoke({action:"DO_MACK_IMG",data:{imgUrl:a}})}function K(){qqmusicBridge.invoke({action:"SONG_GET_LIST_INFO"},function(a){a&&0==a.code?a.uin==l&&a.geneId==m&&a.list&&a.list.length?(k=a.index,h=a.list,I(),LS&&LS.gene_info?($(".gene_info").html(LS.gene_info),document.title=M.unescape($(".gene_name").html())):B()):B():B()}),qqmusicBridge.onApp("CALLPAGE_SONG_TIME_UPDATE",function(a){if(a&&1==a.state&&a.songId==i.songId){var b=parseInt(360*(a.curTime/a.totalTime));t.to(b),d.showCurrentLrcLine(a.curTime)}},function(a){a&&0==a.code||M.tips("播放进度回调事件绑定失败!"+a)}),FastClick.attach(document.body),w.init(),qqmusicBridge.onApp("CALLPAGE_SONG_STATE_CHANGE",function(a){if(a){if(-1001==a.state)return L(),!1;if(101==a.code)return $("#play").removeClass("pause"),!1;if(-1003==a.code)return M.tips("正在进行多人语音, 无法播放!"),!1;k=a.index,1==a.state?p(function(a){1!=a&&-1!=a&&1!=$.cookie.get("gene_agree_play")?qqmusicBridge.invoke({action:"SONG_PAUSE"},function(){mqq.ui.showDialog({title:"提示",text:"您当前可能不是WIFI网络,继续播放会消耗流量.确定继续播放?"},function(a){a&&0==a.button&&($.cookie.set("gene_agree_play",1,"","",1),qqmusicBridge.invoke({action:"SONG_RESUME"}))})}):I()}):I()}else M.tips("获取播放状态出错")},function(a){a&&0==a.code||M.tips("播放状态回调事件绑定失败!"+a)}),qqmusicBridge.onApp("DO_MACK_IMG_CALLBACK",function(a){if(a&&a.data.imgUrl){var b=new Image;b.src=a.data.imgUrl,$("#bg")[0].style.backgroundImage="url("+b.src+")"}}),qqmusicBridge.bind("CALLPAGE_SHARE",function(){return i.songId?((!$.os.ios||mqq.invoke("ui","pageVisibility"))&&qqmusicBridge.invoke({action:"SHARE_SONG",data:{title:i.songName,desc:i.singerName,imgUrl:i.albumImg,src:"http://data.music.qq.com/playsong.html?songid="+i.songId+"&source=qqgene&_wv=3",audioUrl:i.playUrl}},function(a){M.tj.sendClick("gene.sharesong")}),void 0):(M.tips("页面正忙，请过一会再分享吧！"),!1)}),$(".ctrl_btn .play").click(function(){return M.tj.sendClick("gene.play"),$(this).hasClass("pause")?qqmusicBridge.invoke({action:"SONG_PAUSE"}):2==i.state?qqmusicBridge.invoke({action:"SONG_RESUME"}):4==i.state?alert("歌曲正在加载中,请稍候!"):F(k,!0),!1}),$(".ctrl_btn .prev").click(function(){return 4!=i.state?(M.tj.sendClick("gene.prev"),E(function(){qqmusicBridge.invoke({action:"SONG_GET_LIST_INFO"},function(a){if(a&&0==a.code)qqmusicBridge.invoke({action:"SONG_PLAY_PREV"});else{var b=k-1;0>=k&&(b=(h.length||1)-1),F(b)}})}),!1):void 0}),$(".ctrl_btn .next").click(function(){return 4!=i.state?(M.tj.sendClick("gene.next"),E(function(){qqmusicBridge.invoke({action:"SONG_GET_LIST_INFO"},function(a){if(a&&0==a.code)qqmusicBridge.invoke({action:"SONG_PLAY_NEXT"});else{var b=k+1;k>=h.length-1&&(b=0),F(b)}})}),!1):void 0}),$(".love").click(function(){return $(this).hasClass("loved")?(M.tj.sendClick("gene.dellove"),z(i.songId,function(a){a&&($(".love").removeClass("loved"),M.tips('歌曲已从QQ音乐"我喜欢"歌单中删除'))})):(M.tj.sendClick("gene.addlove"),y(i.songId,function(a){a&&($(".love").addClass("loved"),M.tips('歌曲已收藏到QQ音乐"我喜欢"歌单',"succ"))})),!1}),$(".download").click(function(){return $("#download_tip").addClass("on"),$(".mask").show(),!1}),$(".mask,.btn.cancel").click(function(){return $("#download_tip").removeClass("on"),$(".mask").hide(),!1}),$(".openInMusic").click(function(){return M.tj.sendClick("openmusic."+($.os.ios?"iphone":"android")+".gene.collect"),g(i),$("#download_tip").removeClass("on"),$(".mask").hide(),!1}),document.addEventListener("touchmove",function(a){a.preventDefault()},!1),M.loadjs("http://imgcache.gtimg.cn/music/mobile/gene/js/iscroll.min.js?max_age=2592000",function(){iScroll&&(M.scrollLrc=new iScroll("scroll_lrc",{hScroll:!1}),$("#mod_lrc").on("touchstart",function(){M.scrollLrc.lockTimer&&clearTimeout(M.scrollLrc.lockTimer),M.scrollLrc.lock=!0}),$("#mod_lrc").on("touchend touchcancel",function(){M.scrollLrc.lockTimer=setTimeout(function(){M.scrollLrc.lock=!1},1e3)}))}),M.loadjs("http://imgcache.gtimg.cn/music/mobile/gene/js/ping.m.js?max_age=25920000",function(){M.tj.pv({ADTAG:M.getParameter("ADTAG")})})}function L(){j.innerHTML='<div class="mod_prompt network"><h6>网络出错</h6><p>您的网络不稳定，建议检查后<br />点击屏幕重试</p></div>',$("body").click(function(){location.reload()})}var a,b,c,d,e,h,i,j,k,l,m,n,o,q,r,s,t,w;SPD.mark(0),M.buildUrl=function(a,b){var c,d,e,f;return"string"==typeof a&&(a.indexOf("?")<0&&(a+="?"),a.indexOf("g_tk=")<0&&(c=/\.(js|json)$/i,e=(d=a.indexOf("?")>-1)?a.split("?")[0]:a,c.lastIndex=0,c.test(e)||(a+=(d?"&":"?")+"g_tk="+getACSRFToken())),M.mmskey&&(a+="&mmskey="+M.mmskey),M.userInfo&&M.userInfo.AUTHST&&(a+="&authkey="+M.userInfo.AUTHST,a+="&authKey="+M.userInfo.AUTHST)),f={uin:M.getUin()||0,jsonpCallback:b||"MusicJsonCallback",hostUin:0,format:"jsonp",inCharset:"utf-8",outCharset:"utf-8",notice:0,platform:"activity",needNewCode:1},a+="&t="+(new Date).getTime(),a+="&"+$.param(f)},window.MUSIC=window.MUSIC||{},a="http://imgcache.qq.com/music/js/tool/html/fp_gbk.html",b=function(a,b){var c=Array.prototype.slice,d=c.call(arguments,2);return function(){return a=a||this,b="string"==typeof b?a[b]:b,b="function"==typeof b?b:emptyFn,b.apply(a,d.concat(c.call(arguments,0)))}},MUSIC.emptyFn=function(){},c=MUSIC.FormSender=function(b,c,d,e){this.name="_fpInstence_"+MUSIC.FormSender.counter,MUSIC.FormSender.instance[this.name]=this,MUSIC.FormSender.counter++,this.method=c||"POST",this.uri=b,this.data="object"==typeof d||"string"==typeof d?d:null,this.proxyURL="string"==typeof e&&"UTF-8"==e.toUpperCase()?a.replace(/_gbk/,"_utf8"):a,this._sender=null,this.onSuccess=MUSIC.emptyFn,this.onError=MUSIC.emptyFn},MUSIC.FormSender.instance={},MUSIC.FormSender.counter=0,MUSIC.FormSender._errCodeMap={999:{msg:"Connection or Server error"}},MUSIC.FormSender.pluginsPool={formHandler:[]},MUSIC.FormSender._pluginsRunner=function(a,b){var f,g,c=MUSIC.FormSender,d=c.pluginsPool[a],e=b;if(d&&(f=d.length))for(g=0;f>g;++g)"function"==typeof d[g]&&(e=d[g](e));return e},MUSIC.FormSender.prototype.send=function(){function a(a){a&&(a._sender=null),setTimeout(function(){$("#_fp_frm_"+a.name).remove()},50)}var c,d;return"POST"==this.method&&null==this.data?!1:(document.domain="qq.com",(null===this._sender||void 0===this._sender)&&(c=document.createElement("iframe"),c.id="_fp_frm_"+this.name,c.style.cssText="width:0;height:0;border-width:0;display:none;",document.body.appendChild(c),c.callback=b(this,function(b){clearTimeout(d),this.onSuccess(b),a(this)}),c.errorCallback=b(this,function(b){clearTimeout(d),this.onError(b),a(this)}),"undefined"!=typeof c.onreadystatechange?c.onreadystatechange=b(this,function(){"complete"==this._sender.readyState&&this._sender.submited&&(a(this),this.onError(MUSIC.FormSender._errCodeMap[999]))}):d=setTimeout(b(this,function(){try{var b=this._sender.contentWindow.location.href;0==b.indexOf(this.uri)&&(clearTimeout(d),a(this),this.onError(MUSIC.FormSender._errCodeMap[999]))}catch(c){clearTimeout(d),a(this),this.onError(MUSIC.FormSender._errCodeMap[999])}}),200),this._sender=c),this._sender.src=this.proxyURL,!0)},MUSIC.FormSender.prototype.destroy=function(){var a=this.name;return delete MUSIC.FormSender.instance[a]._sender,MUSIC.FormSender.instance[a]._sender=null,delete MUSIC.FormSender.instance[a],MUSIC.FormSender.counter--,null},d={lrcList:[],elem:null,album:"",artist:"",songTitle:"",byBody:"",offset:"",maxLineIndex:0,cLine:null,scrollDiv:null,checkY:function(a){if(!this.elem)return!1;var b=parseInt(this.elem.parent().height())-parseInt(this.elem.height());return b>a&&(a=b),a>0&&(a=0),a},parseLyricData:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q;for(this.lrcList=[],b=this,c=a.replace(new RegExp("\\n","g"),"_!!_").trim(),e=[],f=0,g=0,e=c.split("_!!_"),g=e.length;g>f;f++)for(h=e[f],i=h.lastIndexOf("]"),j=h.substring(0,i+1),k=h.substring(i+1),l=j.replace(new RegExp("\\[","g"),"").split("]"),m=l.length,n=m-1,o="",p=0;n--;)o=l[n],-1!=o.indexOf("al:")?(p=o.indexOf(":"),b.album=o.substring(p+1)):-1!=o.indexOf("ar:")?(p=o.indexOf(":"),b.artist=o.substring(p+1)):-1!=o.indexOf("ti:")?(p=o.indexOf(":"),b.songTitle=o.substring(p+1)):-1!=o.indexOf("by:")?(p=o.indexOf(":"),b.byBody=o.substring(p+1)):-1!=o.indexOf("offset:")?(p=o.indexOf(":"),b.offset=o.substring(p+1)):(o=-1!=o.indexOf(".")?o:o+".00",k=k.trim(),q=parseInt(b.playTime2ms(o)-b.offset,10),o=b.ms2playTime(q),k&&b.lrcList.push({time:o,context:k}));b.lrcList.sort(function r(a,b){return d.compare(a.time,b.time)?-1:1}),b.maxLineIndex=b.lrcList.length},playTime2ms:function(a){var b=1e3*60*parseInt(a.substring(0,a.indexOf(":")),10),c=1e3*parseInt(a.substring(a.indexOf(":")+1,a.indexOf(".")),10),d=parseInt(a.substring(a.indexOf(".")+1),10);return b+c+d},ms2playTime:function(a){var b=parseInt(a/6e4,10),c=parseInt(a/1e3%60,10),d=a-6e4*b-1e3*c;return(b>9?"":"0")+b+":"+(c>9?"":"0")+c+"."+(d>9?"":"0")+d},compare:function(a,b,c){var e=d;return c=c||"<=","<"==c?e.playTime2ms(a)<e.playTime2ms(b):"<="==c?e.playTime2ms(a)<=e.playTime2ms(b):">"==c?e.playTime2ms(a)>e.playTime2ms(b):">="==c?e.playTime2ms(a)>=e.playTime2ms(b):void 0},getLrc:function(a,b){var d,c=this;this.elem=$(b),this.elem.empty(),d="<p>该歌曲暂无歌词</p>",$.ajax({url:"http://portalcgi.music.qq.com/fcgi-bin/fcg_query_lyric.fcg?nobase64=1&musicid="+a+"&pcachetime="+(new Date).getTime(),dataType:"jsonp",success:function(a){if(a&&0==a.retcode)if(3!=a.type){c.parseLyricData(M.unescape(a.lyric));var b=c.makeLrcHtml();b?(c.elem.html(b),M.scrollLrc&&M.scrollLrc.refresh()):c.elem.html(d)}else c.elem.html(d);else c.elem.html(d)},error:function(){c.elem.html("<p>获取歌词失败,请稍候再试</p>")}})},showCurrentLrcLine:function(a){var b,c,e,f;for(a=parseInt(a),b=this.lrcList.length,c=0;b>c&&(e=parseInt(d.playTime2ms(this.lrcList[c].time)/1e3),!(e>a));c++);f=document.getElementById("line_"+(c-1)),f&&d.cLine!=f&&(d.cLine&&(d.cLine.className=""),f.className="current",d.cLine=f),this.scrollLrcLine(c-2)},currentLine:null,scrollLrcLine:function(a){var b;return null!==this.currentLine&&a==this.currentLine?!1:(this.currentLine=a,a=parseInt(a),0>a&&(a=0),b=-(28*a),b=this.checkY(b),M.scrollLrc&&!M.scrollLrc.lock&&this.elem&&this.elem[0]&&(this.elem[0].style.webkitTransition="-webkit-transform 0.3s ease-out",this.elem[0].style.webkitTransform="translate3d(0px,"+b+"px,0px)"),void 0)},makeLrcHtml:function(){var b,c,d,a=this.lrcList;if(a){for(b=a.length,c=0,d=[];b>c;c++)d.push('<p id="line_'+c+'">'+a[c].context+"</p>");return d.push("<p>(完)</p>"),d.join("")}return""}},e={downAndroid:"http://misc.wcd.qq.com/app?packageName=com.tencent.qqmusic&channelId=10000434",downIphone:"https://itunes.apple.com/cn/app/qq-yin-le/id414603431?mt=8",open:function(a){navigator.userAgent.match(/iPhone|iPod|iPad/)?this.openIphone(a):this.openAndroid(a)},openAndroid:function(a){mqq.app.isAppInstalled("com.tencent.qqmusic",function(b){b?location.href=a:M.qqver>=4.6?M.loadjs("http://pub.idqqimg.com/qqmobile/jsbridge.js?v=20130913",function(){var a={appid:"100686922",url:e.downAndroid,packageName:"com.tencent.qqmusic",dType:"1",actionType:"900",actionCode:"2",via:"ANDROIDQQ.QQMUSIC.GENE",appName:"QQMUSIC",notifyKey:"nothing"};JsBridge.callMethod("q_download","doDownloadAction",JSON.stringify(a))}):window.location.href=e.downAndroid})},openIphone:function(a){mqq.app.isAppInstalled("qqmusic",function(b){window.location.href=b?a:e.downIphone})}},h=[],i={},j=document.body,k=0,M.audioServer="cc",M.netWork=-1,l=M.getUin(),M.getParameter("uin")&&(l=M.getParameter("uin")),m=M.getParameter("id"),n=M.getParameter("type"),o=M.getParameter("name"),o&&(document.title=decodeURIComponent(o)),l&&m&&n||alert("访问参数错误!"),p(),q=document.documentElement.clientWidth,r=document.documentElement.clientHeight,s="",$.os.ios&&parseFloat($.os.version)>=7||$.os.android&&parseFloat($.os.version)>=4.4||(s+=" nosysbar"),$.os.ios&&(s+=" ios"),500>r&&(s+=" short_screen"),document.body.className+=s,t={canvas:document.getElementById("canvas"),ctx:this.canvas.getContext("2d"),w:canvas.width,h:canvas.height,deg:0,color:"#fff",timer:null,draw:function(){this.ctx.clearRect(0,0,this.w,this.h);var a=this.deg*Math.PI/180;this.ctx.beginPath(),this.ctx.strokeStyle=this.color,this.ctx.lineWidth=6,this.ctx.arc(this.w/2,this.h/2,198,0-90*Math.PI/180,a-90*Math.PI/180,!1),this.ctx.stroke()},to:function(a,b){var c=this,d=a-this.deg,e=d/25;e=1>e?e:1,this.timer&&clearInterval(this.timer),b?(this.deg=a,c.draw()):this.timer=setInterval(function(){c.deg==a&&clearInterval(c.timer),c.deg<=a&&(c.deg+=e),c.draw()},40)}},w={init:function(){this.touchInitPos=0,this.startPos=0,this.totalDist=0,this.deltaX1=0,this.deltaX2=0;var a=this;$(".slide").on("touchstart",function(b){a.touchstart(b)},!1),$(".slide").on("touchmove",function(b){a.touchmove(b)},!1),$(".slide").on("touchend",function(b){a.touchend(b)},!1),$(".slide").on("touchcancel",function(b){a.touchend(b)},!1)},touchstart:function(a){1===a.touches.length&&(this.touchInitPos=a.touches[0].pageX,this.touchInitPosY=a.touches[0].pageY,this.deltaX1=this.touchInitPos,this.initPos=this.startPos=parseInt($(".slide")[0].style.WebkitTransform.replace(/.*\((.*)?px.*/,"$1"))||0,this.startPosPrev=-q,this.startPosNext=q,M.slide_h=!0,M.slide_v=!0)},touchmove:function(a){var b,c;1===a.touches.length&&(Math.abs(a.touches[0].pageY-this.touchInitPosY)<Math.abs(a.touches[0].pageX-this.deltaX1)?(M.slide_h=!0,M.slide_v=!1):(M.slide_h=!1,M.slide_v=!0),M.slide_h&&(b=a.touches[0].pageX,this.deltaX2=b-this.deltaX1,this.totalDist=this.startPos+b-this.touchInitPos,c=this.totalDist+"px,0",document.getElementById("slide").style.cssText="-webkit-transition-duration:0;-webkit-transform: translate3d("+c+"px, 0);",this.startPos=this.totalDist,this.touchInitPos=b,a.preventDefault()))},touchend:function(a){this.deltaX2<-30?v():this.deltaX2>30?u():this.restore(),this.deltaX2=0},restore:function(){$(".slide")[0].style.cssText+="-webkit-transition-duration:500ms;-webkit-transform: translate3d("+this.initPos+"px,0,0);"}},x.lock=!1,M.imgerror=function(){$(".pic").html(""),$("#bg")[0].style.backgroundImage=""},H.id=null,mqq.device.getClientInfo?mqq.device.getClientInfo(function(a){M.qqver=parseFloat(a.qqVersion),M.qqver<4.7?j.innerHTML='<div class="mod_prompt"><h6>您的QQ版本不支持</h6><p><a href="http://fwd.3g.qq.com:8080/forward.jsp?bid=1054">点击升级到最新版本</a></p></div>':K()}):alert("抱歉!本应用只支持在手机QQ中打开!"),window.onload=function(){SPD.mark(3),SPD.send(SPD._timing)}}();</script>
</body>
</html>